import{E as G,d as q,K as H,L,k as $,R as J,S as K,aH as Q,i as W,aI as z,j as _,m as R,t as l,a6 as X,c as M,b as w,e as D,u as e,a as n,w as d,o as V,z as C,A as m,B as N,l as T,C as j,aj as Y,_ as Z,a7 as ee}from"./index-abec4112.js";import{N as S,_ as ae}from"./index.vue_vue_type_script_setup_true_lang-0b03c87c.js";import{N as E}from"./Grid-4ac813f4.js";import{N as g}from"./FormItemGridItem-bf1bf4be.js";import{N as I}from"./Upload-9e5f54bf.js";import{N as F}from"./Switch-5d1c8ac0.js";import{N as O}from"./Form-94767fab.js";import{N as le}from"./Avatar-0b9bedef.js";import"./FormItem-8daefc5e.js";import"./Image-90ddb2f4.js";const te=G("a",`
 cursor: pointer;
 transition:
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier);
 text-decoration-color: var(--n-text-color);
 color: var(--n-text-color);
`),oe=Object.assign({},L.props),ne=q({name:"A",props:oe,setup(p){const{mergedClsPrefixRef:v,inlineThemeDisabled:s}=H(p),a=L("Typography","-a",te,Q,p,v),f=$(()=>{const{common:{cubicBezierEaseInOut:y},self:{aTextColor:k}}=a.value;return{"--n-text-color":k,"--n-bezier":y}}),u=s?J("a",void 0,f,p):void 0;return{mergedClsPrefix:v,cssVars:s?void 0:f,themeClass:u==null?void 0:u.themeClass,onRender:u==null?void 0:u.onRender}},render(){var p;return(p=this.onRender)===null||p===void 0||p.call(this),K("a",{class:[`${this.mergedClsPrefix}-a`,this.themeClass],style:this.cssVars},this.$slots)}});function P(p){const{isMobile:v}=W(),s=$(()=>v?24:12);z();const a=_(),f=R(null),u=R(!1),y={name:[{required:!0,message:l("common.nameRequired"),trigger:["input","blur"]}],apiUrl:[{required:!0,message:l("common.apiUrlRequired"),trigger:["input","blur"]}],apiKey:[{required:!0,message:l("common.apiKeyRequired"),trigger:["input","blur"]}]},k=async({file:x,data:U,onFinish:c,onError:t,onProgress:i})=>{try{if(!U)throw new Error("dataParams is undefined");const b={loaded:20,total:100},B=Math.round(b.loaded*100/b.total);i({percent:B});const{data:o,error:r}=await X.storage.from(U.bucket).upload(`${x.name}`,x.file,{cacheControl:"3600",upsert:!1});if(r)if(r.statusCode==="409"&&r.error==="Duplicate")p.value.logoUrl=x.name,c();else throw r;o&&(p.value.logoUrl=o.path,c())}catch(b){console.log(b),a.error(b.message),t()}};function h(){return!p.value.name||!p.value.apiUrl||!p.value.apiKey||u.value}function A(x,U){var c;x.preventDefault(),(c=f.value)==null||c.validate(t=>{t?a.error(l("auth.fillAllField")):U()})}return{span:s,formRef:f,loading:u,rules:y,customRequest:k,isButtonDisabled:h,handleValidateButtonClick:A}}const re={class:"border-none shadow-none flex flex-col gap-2 p-2 rounded-lg"},se={class:"post-heading mb-1"},ie={class:"gtext text-2xl font-bold underlined"},ue={style:{display:"flex","justify-content":"flex-end"}},de=q({__name:"Add",setup(p){const v=z(),s=R(v.initState()),{span:a,formRef:f,loading:u,rules:y,customRequest:k,isButtonDisabled:h,handleValidateButtonClick:A}=P(s),x=_();async function U(){try{u.value=!0,await v.insertDataAction(s.value),u.value=!1,v.showModelAdd=!1,x.success(l("common.addSuccess"))}catch(c){u.value=!1,console.error(l("common.addFailed"),c.message),x.error(l("common.addFailed"),c.message)}}return(c,t)=>(V(),M("div",re,[w("div",se,[w("div",ie,D(e(l)("common.addNew")),1)]),n(e(O),{ref_key:"formRef",ref:f,model:s.value,rules:e(y),size:"large"},{default:d(()=>[w("div",null,[n(e(E),null,{default:d(()=>[n(e(g),{span:e(a),path:"logoUrl",label:e(l)("common.logoUrl")},{default:d(()=>[n(e(I),{accept:"image/*","list-type":"image-card",max:1,data:{bucket:"company"},path:"logoUrl","custom-request":e(k)},null,8,["custom-request"])]),_:1},8,["span","label"]),n(e(g),{span:e(a),path:"name",label:e(l)("common.name")},{default:d(()=>[n(e(C),{value:s.value.name,"onUpdate:value":t[0]||(t[0]=i=>s.value.name=i),onKeyup:t[1]||(t[1]=m(i=>e(A)(i,U),["enter"])),placeholder:e(l)("common.name"),clearable:"",onKeydown:t[2]||(t[2]=m(N(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(g),{span:e(a),path:"companyUrl",label:e(l)("common.companyUrl")},{default:d(()=>[n(e(C),{value:s.value.companyUrl,"onUpdate:value":t[3]||(t[3]=i=>s.value.companyUrl=i),onKeyup:t[4]||(t[4]=m(i=>e(A)(i,U),["enter"])),placeholder:e(l)("common.companyUrl"),clearable:"",onKeydown:t[5]||(t[5]=m(N(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(g),{span:e(a),path:"apiUrl",label:e(l)("common.apiUrl")},{default:d(()=>[n(e(C),{value:s.value.apiUrl,"onUpdate:value":t[6]||(t[6]=i=>s.value.apiUrl=i),onKeyup:t[7]||(t[7]=m(i=>e(A)(i,U),["enter"])),placeholder:e(l)("common.apiUrl"),clearable:"",onKeydown:t[8]||(t[8]=m(N(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(g),{span:e(a),path:"apiKey",label:e(l)("common.apiKey")},{default:d(()=>[n(e(C),{value:s.value.apiKey,"onUpdate:value":t[9]||(t[9]=i=>s.value.apiKey=i),onKeyup:t[10]||(t[10]=m(i=>e(A)(i,U),["enter"])),placeholder:e(l)("common.apiKey"),clearable:"",onKeydown:t[11]||(t[11]=m(N(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(g),{span:e(a),path:"isActivate",label:e(l)("common.isActivate")},{default:d(()=>[n(e(F),{value:s.value.isActivate,"onUpdate:value":t[12]||(t[12]=i=>s.value.isActivate=i),size:"large"},null,8,["value"])]),_:1},8,["span","label"])]),_:1})]),w("div",ue,[n(e(T),{type:"primary",style:{width:"100%"},size:"large",loading:e(u),disabled:e(h)(),onClick:t[13]||(t[13]=i=>e(A)(i,U))},{default:d(()=>[j(D(e(l)("common.addNew")),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["model","rules"])]))}}),pe={class:"border-none shadow-none flex flex-col gap-2 p-2 rounded-lg"},me={class:"post-heading mb-1"},ce={class:"gtext text-2xl font-bold underlined"},ve={style:{display:"flex","justify-content":"flex-end"}},fe=q({__name:"Update",props:{item:{}},setup(p){const v=p,s=z(),a=R({...v.item}),f=R({...v.item}),u=_(),{span:y,formRef:k,loading:h,rules:A,customRequest:x,isButtonDisabled:U,handleValidateButtonClick:c}=P(a),t=R([{id:"",name:a.value.logoUrl??"",status:"finished",url:a.value.logoUrl}]),i=$(()=>h.value||!a.value.name||!a.value.apiUrl||JSON.stringify(a.value)===JSON.stringify(f.value));async function b(){try{h.value=!0,a.value.logoUrl===f.value.logoUrl&&delete a.value.logoUrl,await s.updateDataAction(a.value),h.value=!1,s.showModelUpdate=!1,u.success(l("common.updateSuccess"))}catch(B){h.value=!1,console.error(l("common.updateFailed"),B.message),u.error(l("common.updateFailed"),B.message)}}return(B,o)=>(V(),M("div",pe,[w("div",me,[w("div",ce,D(e(l)("common.update")),1)]),n(e(O),{ref_key:"formRef",ref:k,model:a.value,rules:e(A),size:"large"},{default:d(()=>[w("div",null,[n(e(E),{span:e(y),"x-gap":24},{default:d(()=>[n(e(g),{span:e(y),path:"logoUrl",label:e(l)("common.logoUrl")},{default:d(()=>[n(e(I),{accept:"image/*","list-type":"image-card",max:1,path:"logoUrl",data:{bucket:"company"},"default-file-list":a.value.logoUrl?t.value:[],"custom-request":e(x)},null,8,["default-file-list","custom-request"])]),_:1},8,["span","label"]),n(e(g),{span:e(y),path:"name",label:e(l)("common.name")},{default:d(()=>[n(e(C),{value:a.value.name,"onUpdate:value":o[0]||(o[0]=r=>a.value.name=r),onKeyup:o[1]||(o[1]=m(r=>e(c)(r,b),["enter"])),placeholder:e(l)("common.name"),clearable:"",onKeydown:o[2]||(o[2]=m(N(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(g),{span:e(y),path:"companyUrl",label:e(l)("common.companyUrl")},{default:d(()=>[n(e(C),{value:a.value.companyUrl,"onUpdate:value":o[3]||(o[3]=r=>a.value.companyUrl=r),onKeyup:o[4]||(o[4]=m(r=>e(c)(r,b),["enter"])),placeholder:e(l)("common.companyUrl"),clearable:"",onKeydown:o[5]||(o[5]=m(N(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(g),{span:e(y),path:"apiUrl",label:e(l)("common.apiUrl")},{default:d(()=>[n(e(C),{value:a.value.apiUrl,"onUpdate:value":o[6]||(o[6]=r=>a.value.apiUrl=r),onKeyup:o[7]||(o[7]=m(r=>e(c)(r,b),["enter"])),placeholder:e(l)("common.apiUrl"),clearable:"",onKeydown:o[8]||(o[8]=m(N(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(g),{span:e(y),path:"apiKey",label:e(l)("common.apiKey")},{default:d(()=>[n(e(C),{value:a.value.apiKey,"onUpdate:value":o[9]||(o[9]=r=>a.value.apiKey=r),onKeyup:o[10]||(o[10]=m(r=>e(c)(r,b),["enter"])),placeholder:e(l)("common.apiKey"),clearable:"",onKeydown:o[11]||(o[11]=m(N(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(g),{span:e(y),path:"isActivate",label:e(l)("common.isActivate")},{default:d(()=>[n(e(F),{value:a.value.isActivate,"onUpdate:value":o[12]||(o[12]=r=>a.value.isActivate=r),size:"large"},null,8,["value"])]),_:1},8,["span","label"])]),_:1},8,["span"])]),w("div",ve,[n(e(T),{type:"primary",style:{width:"100%"},size:"large",loading:e(h),disabled:i.value,onClick:o[13]||(o[13]=r=>e(c)(r,b))},{default:d(()=>[j(D(e(l)("common.update")),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["model","rules"])]))}}),Ne=q({__name:"List",setup(p){const v=z(),s=Y([{title:l("common.name"),key:"name",align:"center",render(a){return K(S,{strong:!0},{default:()=>a.name})}},{title:l("common.companyUrl"),key:"companyUrl",align:"center",render(a){return a.companyUrl?K(ne,{href:a.companyUrl,target:"_blank"},{default:()=>a.companyUrl}):null},ellipsis:!0},{title:l("common.logoUrl"),key:"logoUrl",align:"center",render(a){const f=a.logoUrl!==null&&a.logoUrl!==void 0&&a.logoUrl.trim()!=="",u=K(Z,{icon:"mdi:company",class:"text-lg text-primary"});return f?K(le,{round:!0,src:a.logoUrl,size:"large"}):u},ellipsis:!0},{title:l("common.apiUrl"),key:"apiUrl",align:"center",render(a){return K(S,{type:"info"},{default:()=>a.apiUrl})},ellipsis:!0},{title:l("common.apiKey"),key:"apiKey",align:"center",render(a){return K(S,{type:"info"},{default:()=>a.apiKey})},ellipsis:!0},{title:l("common.isActivate"),key:"isActivate",align:"center",render(a){return K(F,{value:a.isActivate,disabled:!0})}},{title:l("common.createdAt"),key:"createdAt",align:"center",render(a){return K(S,{},{default:()=>new Date(a.createdAt).toLocaleString()})}},{title:l("common.updatedAt"),key:"updatedAt",align:"center",render(a){return K(S,{},{default:()=>new Date(a.updatedAt).toLocaleString()})}}]);return(a,f)=>(V(),ee(e(ae),{title:e(l)("common.company"),modelStore:e(v),columns:s,Add:de,Update:fe},null,8,["title","modelStore","columns"]))}});export{Ne as default};
